# $Id$

INCLUDES = -I$(top_srcdir)/include

sbin_PROGRAMS = varnishd

dist_man_MANS = varnishd.1

varnishd_SOURCES = \
	cache_acceptor.c \
	cache_acceptor_epoll.c \
	cache_acceptor_poll.c \
	cache_acceptor_kqueue.c \
	cache_backend.c \
	cache_backend_random.c \
	cache_backend_round_robin.c \
	cache_backend_simple.c \
	cache_ban.c \
	cache_center.c \
	cache_cli.c \
	cache_expire.c \
	cache_fetch.c \
	cache_hash.c \
	cache_http.c \
	cache_httpconn.c \
	cache_main.c \
	cache_pool.c \
	cache_pipe.c \
	cache_response.c \
	cache_session.c \
	cache_synthetic.c \
	cache_vary.c \
	cache_vcl.c \
	cache_vrt.c \
	cache_vrt_acl.c \
	cache_vrt_re.c \
	cache_vrt_esi.c \
	cache_ws.c \
	hash_simple_list.c \
	hash_classic.c \
	instance.c \
	mgt_child.c \
	mgt_cli.c \
	mgt_event.c \
	mgt_param.c \
	mgt_vcc.c \
	rfc2616.c \
	shmlog.c \
	stevedore.c \
	storage_file.c \
	storage_malloc.c \
	tcp.c \
	varnishd.c

noinst_HEADERS = \
	cache.h \
	cache_acceptor.h \
	common.h \
	hash_slinger.h \
	heritage.h \
	mgt.h \
	mgt_cli.h \
	mgt_event.h \
	steps.h \
	stevedore.h

varnishd_CFLAGS = -include config.h

varnishd_LDFLAGS = -export-dynamic

varnishd_LDADD = \
	$(top_builddir)/lib/libvarnish/libvarnish.la \
	$(top_builddir)/lib/libvarnishcompat/libvarnishcompat.la \
	$(top_builddir)/lib/libvcl/libvcl.la \
	${DL_LIBS} ${PTHREAD_LIBS} ${NET_LIBS} ${LIBM}
